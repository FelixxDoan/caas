{
  "url": "https://www.w3schools.com/html/html5_webworkers.asp",
  "title": "HTML ",
  "content": [
    {
      "type": "heading",
      "level": 1,
      "text": "HTML Web Workers API"
    },
    {
      "type": "other",
      "text": "❮ Previous\nNext ❯"
    },
    {
      "type": "paragraph",
      "text": "A web worker is an external JavaScript file that runs in the background, without affecting the performance of the page."
    },
    {
      "type": "heading",
      "level": 2,
      "text": "What is a Web Worker?"
    },
    {
      "type": "paragraph",
      "text": "When executing scripts in an HTML page, the page becomes unresponsive until the script is finished."
    },
    {
      "type": "paragraph",
      "text": "A web worker is an external JavaScript file that runs in the background, independently \nof other scripts, without affecting the performance of the page. You can continue to do whatever you want: \nclicking, selecting things, etc., while the web worker runs in the background."
    },
    {
      "type": "paragraph",
      "text": "Web workers are useful for heavy code that can't be run on the main thread, \nwithout causing long tasks that make the page unresponsive."
    },
    {
      "type": "heading",
      "level": 2,
      "text": "Browser Support"
    },
    {
      "type": "paragraph",
      "text": "The numbers in the table specify the first browser version that fully support \nthe Web Workers API."
    },
    {
      "type": "table",
      "data": [
        [
          "API",
          "",
          "",
          "",
          "",
          ""
        ],
        [
          "Web Workers",
          "4.0",
          "10.0",
          "3.5",
          "4.0",
          "11.5"
        ]
      ]
    },
    {
      "type": "heading",
      "level": 2,
      "text": "Web Workers API Example"
    },
    {
      "type": "paragraph",
      "text": "The example below creates a simple web worker that count numbers in the background:"
    },
    {
      "type": "example",
      "description": "",
      "codes": []
    },
    {
      "type": "other",
      "text": "Note: Normally web workers are not used for such simple scripts, but for more CPU intensive tasks!"
    },
    {
      "type": "heading",
      "level": 2,
      "text": "Check Web Worker API Support"
    },
    {
      "type": "paragraph",
      "text": "Before using web worker, we can quickly check browser support:"
    },
    {
      "type": "example",
      "description": "",
      "codes": [
        {
          "language": "javascript",
          "code": "<script>const x = document.getElementById(\"result\");\n  if(typeof(Worker) !== \"undefined\") {  x.innerHTML = \"Your browser \n  support Web Workers!\";} else {  x.innerHTML = \"Sorry, your \n  browser does not support Web Workers.\";}\n  </script>"
        }
      ]
    },
    {
      "type": "heading",
      "level": 2,
      "text": "Create a .js Web Worker File"
    },
    {
      "type": "paragraph",
      "text": "Now, let's create a web worker in an external JavaScript file."
    },
    {
      "type": "paragraph",
      "text": "Here we create a script that counts. The script is stored in the \"demo_workers.js\" file:"
    },
    {
      "type": "code",
      "language": "javascript",
      "code": "var i = 0;\n\nfunction timedCount()\n{\n    \ni = i + 1;\n    \npostMessage(i);\n  setTimeout(\"timedCount()\",500);\n}\n\ntimedCount();"
    },
    {
      "type": "paragraph",
      "text": "Note: The important part of the code above is the postMessage() method - which is used to post messages back to the HTML page."
    },
    {
      "type": "heading",
      "level": 2,
      "text": "Create a Web Worker Object"
    },
    {
      "type": "paragraph",
      "text": "Once we have created the .js web worker file, we can call it from an HTML page."
    },
    {
      "type": "paragraph",
      "text": "The following lines checks if a worker (w) already exists, if not - it creates a new web worker object and \npoints to the .js file: \n\"demo_workers.js\":"
    },
    {
      "type": "code",
      "language": "javascript",
      "code": "if (typeof(w) == \"undefined\") {\n    w = new Worker(\"demo_workers.js\");\n }"
    },
    {
      "type": "paragraph",
      "text": "Then we can SEND and RETRIEVE messages from the web worker."
    },
    {
      "type": "paragraph",
      "text": "Data is sent between web workers and the main thread via a system of messages \n- both sides send their messages using the postMessage() \nmethod, and respond to messages via the onmessage \nevent handler."
    },
    {
      "type": "paragraph",
      "text": "Add an onmessage event listener to the web worker \nobject."
    },
    {
      "type": "code",
      "language": "javascript",
      "code": "w.onmessage = function(event){\n  document.getElementById(\"result\").innerHTML = event.data;\n };"
    },
    {
      "type": "paragraph",
      "text": "When the web worker in the .js posts a message, the code within the event listener is executed. The data \nfrom the web worker is stored in event.data."
    },
    {
      "type": "heading",
      "level": 2,
      "text": "Terminate a Web Worker"
    },
    {
      "type": "paragraph",
      "text": "When a web worker object is created, it will continue to listen for messages until it is terminated."
    },
    {
      "type": "paragraph",
      "text": "To terminate a web worker object, and free browser/computer resources, use the \nterminate() method:"
    },
    {
      "type": "code",
      "language": "unknown",
      "code": "w.terminate();"
    },
    {
      "type": "heading",
      "level": 2,
      "text": "Reuse the Web Worker"
    },
    {
      "type": "paragraph",
      "text": "If you set the web worker variable to undefined, after it has been terminated, \nyou can reuse the worker/code:"
    },
    {
      "type": "code",
      "language": "unknown",
      "code": "w = undefined;"
    },
    {
      "type": "heading",
      "level": 2,
      "text": "Full Web Worker Example"
    },
    {
      "type": "paragraph",
      "text": "We have already seen the Web Worker code in the .js file."
    },
    {
      "type": "paragraph",
      "text": "Below is the full code for the HTML page:"
    },
    {
      "type": "example",
      "description": "",
      "codes": [
        {
          "language": "html",
          "code": "<!DOCTYPE html>\n<html>\n<body>\n\n<p>Count numbers: <output id=\"result\"></output></p>\n<button onclick=\"startWorker()\">Start Worker</button> \n<button onclick=\"stopWorker()\">Stop Worker</button>\n\n<script>\n  let w;\n\nfunction startWorker()\n{  const x = document.getElementById(\"result\");\n   \nif (typeof(Worker) !== \"undefined\")\n{\n    if (typeof(w) == \"undefined\") {\n        w = new Worker(\"demo_workers.js\");\n      }\n    w.onmessage = function(event) {\n        x.innerHTML = event.data;\n    };\n  }\nelse\n{\n     \n  x.innerHTML = \"Sorry! No Web Worker support.\";\n    }\n}\n\nfunction stopWorker()\n{ \n  w.terminate();  w = undefined;\n}\n</script>\n\n</body>\n</html>"
        }
      ]
    },
    {
      "type": "heading",
      "level": 2,
      "text": "Web Workers and the DOM"
    },
    {
      "type": "paragraph",
      "text": "Since web workers are in external .js files, they do not have access to the following JavaScript objects:"
    },
    {
      "type": "other",
      "text": "The window object\n  The document object\n  The parent object"
    },
    {
      "type": "other",
      "text": "❮ Previous\nNext ❯"
    },
    {
      "type": "other",
      "text": "★\n\n      +1\n    \n  \n\n  \n   \n\n  \n    \n      \n        Track your progress - it's free!\n        \n          \n                 \n          \n        \n      \n    \n\n    \n      \n        \n          Log in\n        \n\n        \n          Sign Up"
    },
    {
      "type": "list",
      "ordered": false,
      "items": [
        "The window object",
        "The document object",
        "The parent object"
      ]
    }
  ]
}